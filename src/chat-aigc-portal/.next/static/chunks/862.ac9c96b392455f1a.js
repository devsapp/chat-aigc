"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[862],{4785:function(e,n,i){i.d(n,{Z:function(){return a}});var t=i(5893),l=i(7294),s=i(8226),r=i(9834),o=i(8198),c=i(3625);function a(e){let{value:n}=e,i=function(){let{timeout:e=2e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[n,i]=(0,l.useState)(null),[t,s]=(0,l.useState)(!1),[r,o]=(0,l.useState)(null),c=n=>{clearTimeout(r),o(setTimeout(()=>s(!1),e)),s(n)},a=e=>{if("clipboard"in navigator)navigator.clipboard.writeText(e).then(()=>c(!0)).catch(e=>i(e));else{let n=document.createElement("textarea");n.value=e,n.style.position="absolute",n.style.left="-999999px",document.body.prepend(n),n.select();try{document.execCommand("copy")}catch(e){console.error(e)}finally{n.remove(),c(!0)}}},d=()=>{s(!1),i(null),clearTimeout(r)};return{copy:a,reset:d,error:n,copied:t}}({timeout:500});return(0,t.jsx)(s.u,{label:i.copied?"已复制":"复制",withArrow:!0,position:"right",children:(0,t.jsx)(r.A,{color:i.copied?"teal":"gray",onClick:()=>i.copy(n),children:i.copied?(0,t.jsx)(o.Z,{size:"1rem"}):(0,t.jsx)(c.Z,{size:"1rem"})})})}},862:function(e,n,i){i.r(n),i.d(n,{ConfirmAndSubmit:function(){return T},DingTalkOutGoing:function(){return S},EventBus:function(){return O},Landing:function(){return _}});var t,l,s=i(5893),r=i(7294),o=i(1163),c=i(6894),a=i(9876),d=i(5117),h=i(7841),u=i(1003),x=i(6980),j=i(5033),p=i(4777),g=i(8513),m=i(8333),f=i(6137),k=i(1759),v=i(8060),b=i(7248),C=i(1666),y=i(4785);(t=l||(l={})).Home="/",t.Action="/action";var w=i(5299);let N=e=>{let{content:n}=e;return(0,s.jsx)(w.D,{className:"markdown-container",children:n})};function S(){let[e,{toggle:n}]=(0,k.q)(!1);(0,v.V)({timeout:500});let i=(0,C.s)().outgoing,{postUrl:t,token:l}=i;return(0,s.jsxs)("div",{style:{width:720,padding:20},children:[(0,s.jsxs)(c.r,{children:[(0,s.jsx)(c.r.Col,{span:4,children:"Outgoing Post地址"}),(0,s.jsx)(c.r.Col,{span:8,className:"copy_container",children:(0,s.jsxs)(a.k,{justify:"flex-start",align:"center",direction:"row",children:[(0,s.jsx)(d.x,{fw:700,children:t}),(0,s.jsx)(y.Z,{value:t})]})})]}),(0,s.jsxs)(c.r,{children:[(0,s.jsx)(c.r.Col,{span:4,children:"Outgoing Token"}),(0,s.jsx)(c.r.Col,{span:8,children:(0,s.jsxs)(a.k,{justify:"flex-start",align:"center",direction:"row",children:[(0,s.jsx)(d.x,{fw:700,children:l}),(0,s.jsx)(y.Z,{value:l})]})})]}),(0,s.jsxs)("div",{style:{textAlign:"right"},children:[" ",(0,s.jsx)(h.z,{variant:"subtle",compact:!0,onClick:n,children:"详细指引"})]}),(0,s.jsx)(u.U,{in:e,children:(0,s.jsx)(N,{content:"### chat&\xa0万相机器人设置教程一\n#### 1.钉群中添加机器人\n![image](https://img.alicdn.com/imgextra/i1/O1CN01wg5N0C1f8e5Ton57P_!!6000000003962-0-tps-2710-104.jpg)\n\n![image](https://img.alicdn.com/imgextra/i2/O1CN01rKW15m1dNBQbdMMhr_!!6000000003723-0-tps-980-1890.jpg)\n\n![image](https://img.alicdn.com/imgextra/i1/O1CN01btZU2K25rEey6jTYK_!!6000000007579-0-tps-1352-1112.jpg)\n\n![image](https://img.alicdn.com/imgextra/i3/O1CN01G7WIau1PLth48Va6d_!!6000000001825-0-tps-1362-1092.jpg)\n#### 2.安全设置选择“加签”（后续配置需要）\n![image](https://img.alicdn.com/imgextra/i2/O1CN01xWXhPI1FifE9bdNCA_!!6000000000521-0-tps-1354-1078.jpg)\n#### 3.开启outgoing，并复制页面信息填写到输入框\n![image](https://img.alicdn.com/imgextra/i1/O1CN01u6c2Qq1zd8m7Xz1pW_!!6000000006736-0-tps-1364-1078.jpg)"})})]})}function O(e){let{form:n}=e,[i,{toggle:t}]=(0,k.q)(!1);return(0,s.jsxs)("div",{style:{width:720,padding:20},children:[(0,s.jsx)(x.o,{label:"Webhook",placeholder:"输入钉钉webhook地址",...n.getInputProps("webhook")}),(0,s.jsx)(x.o,{label:"加签Token",placeholder:"输入加签的秘钥",...n.getInputProps("token")}),(0,s.jsxs)("div",{style:{textAlign:"right"},children:[" ",(0,s.jsx)(h.z,{variant:"subtle",compact:!0,onClick:t,children:"详细指引"})]}),(0,s.jsx)(u.U,{in:i,children:(0,s.jsx)(N,{content:"### chat&\xa0万相机器人设置教程二\n#### 1.复制钉钉机器人生成的webhook和加签token\n#### 2.将webhook和token录入页面的输入框."})})]})}function T(e){let{form:n}=e,i=(0,C.s)().outgoing,{postUrl:t,token:l}=i,r=(null==n?void 0:n.values)||{},{webhook:o,token:a}=r;return(0,s.jsxs)("div",{style:{width:720,padding:20},children:[(0,s.jsxs)("div",{children:[" ",(0,s.jsx)(d.x,{fw:700,children:"钉钉outgoing配置："})]}),(0,s.jsxs)(c.r,{children:[(0,s.jsx)(c.r.Col,{span:4,children:"Outgoing Url"}),(0,s.jsx)(c.r.Col,{span:8,children:(0,s.jsx)(j.y,{highlight:t,children:t})})]}),(0,s.jsxs)(c.r,{children:[(0,s.jsx)(c.r.Col,{span:4,children:"Outgoing Token"}),(0,s.jsx)(c.r.Col,{span:8,children:(0,s.jsx)(j.y,{highlight:l,children:l})})]}),(0,s.jsx)(p.i,{my:"sm",variant:"dashed"}),(0,s.jsx)("div",{children:(0,s.jsx)(d.x,{fw:700,children:"事件总线连接配置："})}),(0,s.jsxs)(c.r,{children:[(0,s.jsx)(c.r.Col,{span:4,children:"钉钉webhook"}),(0,s.jsx)(c.r.Col,{span:8,children:(0,s.jsx)(j.y,{highlight:o,children:o})})]}),(0,s.jsxs)(c.r,{children:[(0,s.jsx)(c.r.Col,{span:4,children:"钉钉加签验证Token"}),(0,s.jsx)(c.r.Col,{span:8,children:(0,s.jsx)(j.y,{highlight:a,children:a})})]})]})}function _(){let e=(0,b.c)({initialValues:{webhook:"",token:""},validate:{webhook:e=>e?null:"webhook必填",token:e=>e?null:"token必填"}}),n=(0,o.useRouter)(),[i,t]=(0,r.useState)(!1),[c,a]=(0,r.useState)(0),d=()=>a(e=>e<3?e+1:e),u=()=>a(e=>e>0?e-1:e),x=async function(e){try{t(!0);let i=await fetch("/api/eventbus",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await i.json();"Success"===s.Code&&n.push(l.Action)}catch(e){console.log(e)}finally{t(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.f,{visible:i,overlayBlur:2}),(0,s.jsxs)("form",{onSubmit:e.onSubmit(x),children:[(0,s.jsxs)(m.v,{active:c,onStepClick:a,breakpoint:"sm",children:[(0,s.jsx)(m.v.Step,{label:"钉钉机器人设置",description:"配置钉钉机器人",children:(0,s.jsx)(S,{})}),(0,s.jsx)(m.v.Step,{label:"事件总线设置",description:"配置事件总线连接",children:(0,s.jsx)(O,{form:e})}),(0,s.jsx)(m.v.Completed,{children:(0,s.jsx)(T,{form:e})})]}),(0,s.jsxs)(f.Z,{position:"center",mt:"xl",children:[c>0?(0,s.jsx)(h.z,{variant:"default",onClick:u,children:"返回"}):null,c<2?(0,s.jsx)(h.z,{onClick:1===c?function(){e.validate(),e.isValid()&&d()}:d,children:"下一步"}):null,2===c?(0,s.jsx)(h.z,{type:"submit",children:"确定"}):null]})]})]})}}}]);